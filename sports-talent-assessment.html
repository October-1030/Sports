<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ä½“è‚²äººæ‰è¯„ä¼°ç³»ç»Ÿ - å“åº”å¼ä¼˜åŒ–ç‰ˆ</title>
    <meta name="description" content="ä¸“ä¸ºåäººè®¾è®¡çš„å¾®ä¿¡å°ç¨‹åºé£æ ¼ä½“è‚²äººæ‰è¯„ä¼°ç³»ç»Ÿï¼Œå®Œå…¨å“åº”å¼è®¾è®¡">
    
    <!-- å¤–éƒ¨èµ„æº -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* ===== åŸºç¡€æ ·å¼ ===== */
        :root {
            /* Brilliant é£æ ¼çš„ä¸»è‰²è°ƒ */
            --primary: #29CC57;
            --primary-light: #3de068;
            --primary-dark: #22b34a;

            /* å¤šå½©æ¸å˜ç³»ç»Ÿ - ä¸åŒç»´åº¦ä½¿ç”¨ä¸åŒé¢œè‰² */
            --gradient-genetic: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-current: linear-gradient(135deg, #29CC57 0%, #3de068 100%);
            --gradient-specialty: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-physical: linear-gradient(135deg, #ffa751 0%, #ffe259 100%);
            --gradient-psychology: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);

            --secondary: #f0f8ff;
            --success: #29CC57;
            --warning: #f59e0b;
            --error: #ef4444;
            --text: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --bg: #f8fafc;
            --card: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --radius-lg: 16px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 30%, #f8fafc 60%, #fff5f5 100%);
            color: var(--text);
            line-height: 1.6;
            font-size: 16px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* æ·»åŠ èƒŒæ™¯è£…é¥°å…ƒç´  */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(41, 204, 87, 0.05) 0%, transparent 70%);
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -50px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* ===== å“åº”å¼å®¹å™¨ç³»ç»Ÿ ===== */
        .app-container {
            max-width: 414px;
            margin: 0 auto;
            background: var(--bg);
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 480px) {
            .app-container {
                max-width: 100%;
                box-shadow: none;
            }
        }

        /* å¹³æ¿å’Œå°æ¡Œé¢ */
        @media (min-width: 768px) {
            body {
                background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 50%, #f8fafc 100%);
            }
            
            .app-container {
                max-width: 600px;
                margin: 20px auto;
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow-lg);
            }
        }

        /* æ¡Œé¢ */
        @media (min-width: 1024px) {
            .app-container {
                max-width: 800px;
                margin: 40px auto;
            }
        }

        /* å¤§æ¡Œé¢ */
        @media (min-width: 1200px) {
            .app-container {
                max-width: 900px;
            }
        }

        /* ===== å¤´éƒ¨å¯¼èˆª (Brilliant é£æ ¼) ===== */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 24px 16px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(41, 204, 87, 0.2);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .app-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .app-subtitle {
            font-size: 14px;
            opacity: 0.95;
            font-weight: 400;
        }

        /* ===== æ­¥éª¤æŒ‡ç¤ºå™¨ (å¢å¼ºåŠ¨ç”») ===== */
        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin: 20px 0;
            padding: 12px;
        }

        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .step-dot.active {
            background: white;
            transform: scale(1.8);
            box-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .step-dot.completed {
            background: #ffffff;
            transform: scale(1.3);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
        }

        .step-dot.completed::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary);
            font-size: 12px;
            font-weight: bold;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
            }
            50% {
                opacity: 0.8;
                box-shadow: 0 0 20px rgba(255, 255, 255, 1);
            }
        }

        /* ===== å¡ç‰‡æ ·å¼ (Brilliant é£æ ¼) ===== */
        .card {
            background: var(--card);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            animation: fadeInUp 0.5s ease-out both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(41, 204, 87, 0.3);
            transition: transform 0.3s ease;
        }

        .card:hover .card-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .card-title {
            font-size: 19px;
            font-weight: 700;
            color: var(--text);
            letter-spacing: 0.3px;
        }

        /* ===== è¡¨å•æ ·å¼ ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        .form-label.required::after {
            content: '*';
            color: var(--error);
            margin-left: 4px;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--card);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(41, 204, 87, 0.15);
            transform: translateY(-1px);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* ===== å•é€‰æ¡†å’Œå¤šé€‰æ¡†æ ·å¼ ===== */
        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-item, .checkbox-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--card);
        }

        .radio-item:hover, .checkbox-item:hover {
            border-color: var(--primary);
            background: rgba(41, 204, 87, 0.08);
            transform: translateX(4px);
        }

        .radio-item.selected, .checkbox-item.selected {
            border-color: var(--primary);
            background: rgba(41, 204, 87, 0.15);
            box-shadow: 0 4px 12px rgba(41, 204, 87, 0.2);
        }

        .radio-input, .checkbox-input {
            width: 20px;
            height: 20px;
            margin: 0;
        }

        /* ===== æŒ‰é’®æ ·å¼ (Brilliant é£æ ¼) ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 28px;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            min-height: 52px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
            transition: width 0.1s, height 0.1s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            box-shadow: 0 8px 20px rgba(41, 204, 87, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 28px rgba(41, 204, 87, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--card);
            color: var(--text);
            border: 2px solid var(--border);
            box-shadow: var(--shadow);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #3de068 100%);
            color: white;
            box-shadow: 0 8px 20px rgba(41, 204, 87, 0.3);
        }

        .btn-block {
            width: 100%;
            margin: 16px 0;
        }

        /* æŒ‰é’®åŠ è½½çŠ¶æ€ */
        .btn-loading {
            position: relative;
            pointer-events: none;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            top: 50%;
            left: 50%;
            margin-left: -8px;
            margin-top: -8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== åº•éƒ¨å¯¼èˆª ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: var(--card);
            padding: 12px 16px;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }

        @media (max-width: 480px) {
            .bottom-nav {
                max-width: 100%;
            }
        }

        /* æ¡Œé¢ç«¯åº•éƒ¨å¯¼èˆªä¼˜åŒ– */
        @media (min-width: 768px) {
            .bottom-nav {
                position: static;
                transform: none;
                left: auto;
                bottom: auto;
                margin: 20px;
                border-radius: var(--radius);
                box-shadow: var(--shadow);
                max-width: none;
                width: auto;
                padding: 16px 24px;
                justify-content: center;
                gap: 20px;
            }
            
            .btn {
                min-width: 140px;
                padding: 14px 28px;
                font-size: 16px;
            }
            
            .step {
                padding-bottom: 0;
            }
            
            .result-container {
                padding-bottom: 20px;
            }
        }

        @media (min-width: 1024px) {
            .bottom-nav {
                margin: 32px;
                padding: 20px 32px;
                gap: 24px;
            }
            
            .btn {
                min-width: 160px;
                padding: 16px 32px;
                font-size: 17px;
                min-height: 56px;
            }
        }

        /* ===== ç»“æœå±•ç¤ºæ ·å¼ ===== */
        .result-container {
            padding: 20px 0 80px 0;
        }

        .score-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-radius: var(--radius-lg);
            padding: 32px;
            margin: 16px;
            text-align: center;
            box-shadow: 0 12px 32px rgba(41, 204, 87, 0.3);
            animation: scaleIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes scaleIn {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .total-score {
            font-size: 56px;
            font-weight: 800;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            animation: countUp 1s ease-out;
        }

        @keyframes countUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .score-label {
            font-size: 18px;
            opacity: 0.95;
            font-weight: 500;
            position: relative;
            z-index: 1;
            letter-spacing: 0.5px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--card);
            border-radius: var(--radius);
            margin-bottom: 12px;
            box-shadow: var(--shadow);
        }

        .recommendation-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--success) 0%, #22c55e 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        /* ===== åŠ¨ç”»æ•ˆæœ ===== */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* ===== ç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 480px) {
            .card {
                margin: 12px 8px;
                padding: 16px;
            }
            
            .app-title {
                font-size: 18px;
            }
            
            .card-title {
                font-size: 16px;
            }
        }

        /* ===== å¹³æ¿å’Œæ¡Œé¢ä¼˜åŒ– ===== */
        @media (min-width: 768px) {
            .card {
                margin: 20px;
                padding: 24px;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }
            
            .card:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
            }
            
            .app-title {
                font-size: 24px;
            }
            
            .card-title {
                font-size: 20px;
            }
            
            .form-group {
                margin-bottom: 24px;
            }
            
            .radio-group, .checkbox-group {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 16px;
            }
            
            .radio-item, .checkbox-item {
                padding: 16px;
            }
            
            .chart-container {
                height: 400px;
                margin: 30px 0;
            }
            
            /* é”®ç›˜å¿«æ·é”®æç¤º */
            .keyboard-hint {
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 12px;
                opacity: 0.7;
                z-index: 1001;
            }
            
            /* æ¡Œé¢ç«¯æ»šåŠ¨ä¼˜åŒ– */
            html {
                scroll-behavior: smooth;
            }
            
            /* æ¡Œé¢ç«¯ç„¦ç‚¹çŠ¶æ€ */
            .form-input:focus,
            .form-select:focus,
            .form-textarea:focus,
            .btn:focus {
                box-shadow: 0 0 0 3px rgba(255, 122, 69, 0.3);
            }
        }

        /* ===== å¤§æ¡Œé¢ä¼˜åŒ– ===== */
        @media (min-width: 1024px) {
            .card {
                margin: 24px;
                padding: 32px;
            }
            
            .app-title {
                font-size: 28px;
            }
            
            .card-title {
                font-size: 22px;
            }
            
            .form-group {
                margin-bottom: 28px;
            }
            
            .radio-group, .checkbox-group {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 20px;
            }
            
            .score-card {
                margin: 24px;
                padding: 40px;
            }
            
            .total-score {
                font-size: 64px;
            }
            
            .chart-container {
                height: 450px;
            }
        }

        /* ===== éšè—/æ˜¾ç¤ºæ­¥éª¤ ===== */
        .step {
            display: none;
        }

        .step.active {
            display: block;
        }

        /* ===== åŠ è½½åŠ¨ç”» ===== */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== æ‰“å°æ ·å¼ ===== */
        @media print {
            .bottom-nav,
            .keyboard-hint {
                display: none !important;
            }
            
            .app-container {
                box-shadow: none;
                margin: 0;
                max-width: 100%;
            }
            
            .card {
                break-inside: avoid;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <!-- æ¡Œé¢ç«¯é”®ç›˜æç¤º -->
    <div class="keyboard-hint" style="display: none;">
        å¿«æ·é”®: â† â†’ åˆ‡æ¢æ­¥éª¤ | Enter ä¸‹ä¸€æ­¥ | Esc è¿”å›
    </div>

    <div class="app-container">
        <!-- åº”ç”¨å¤´éƒ¨ -->
        <header class="app-header">
            <h1 class="app-title">ğŸƒâ€â™‚ï¸ ä½“è‚²äººæ‰è¯„ä¼°ç³»ç»Ÿ</h1>
            <p class="app-subtitle">ä¸“ä¸šÂ·æ™ºèƒ½Â·ä¸ªæ€§åŒ–Â·å“åº”å¼</p>
            <div class="step-indicator">
                <div class="step-dot active" data-step="1"></div>
                <div class="step-dot" data-step="2"></div>
                <div class="step-dot" data-step="3"></div>
                <div class="step-dot" data-step="4"></div>
                <div class="step-dot" data-step="5"></div>
            </div>
        </header>

        <!-- æ­¥éª¤1: åŸºæœ¬ä¿¡æ¯ -->
        <div class="step active" data-step="1">
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <h2 class="card-title">åŸºæœ¬ä¿¡æ¯</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label required">å„¿ç«¥å§“å</label>
                    <input type="text" class="form-input" placeholder="è¯·è¾“å…¥å„¿ç«¥å§“å" id="childName">
                </div>

                <div class="form-group">
                    <label class="form-label required">æ€§åˆ«</label>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'gender', 'ç”·', event)">
                            <input type="radio" name="gender" value="ç”·" class="radio-input">
                            <span>ğŸ‘¦ ç”·å­©</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'gender', 'å¥³', event)">
                            <input type="radio" name="gender" value="å¥³" class="radio-input">
                            <span>ğŸ‘§ å¥³å­©</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label required">å‡ºç”Ÿæ—¥æœŸ</label>
                    <input type="date" class="form-input" id="birthDate">
                </div>

                <div class="form-group">
                    <label class="form-label">èº«é«˜ (cm)</label>
                    <input type="number" class="form-input" placeholder="ä¾‹å¦‚: 120" id="height">
                </div>

                <div class="form-group">
                    <label class="form-label">ä½“é‡ (kg)</label>
                    <input type="number" class="form-input" placeholder="ä¾‹å¦‚: 25" id="weight">
                </div>
            </div>

            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h2 class="card-title">çˆ¶æ¯ä¿¡æ¯</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">çˆ¶äº²èº«é«˜ (cm)</label>
                    <input type="number" class="form-input" placeholder="ä¾‹å¦‚: 175" id="fatherHeight">
                </div>

                <div class="form-group">
                    <label class="form-label">æ¯äº²èº«é«˜ (cm)</label>
                    <input type="number" class="form-input" placeholder="ä¾‹å¦‚: 165" id="motherHeight">
                </div>

                <div class="form-group">
                    <label class="form-label">å®¶æ—è¿åŠ¨èƒŒæ™¯</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'family_sports', event)">
                            <input type="checkbox" value="professional" class="checkbox-input">
                            <span>ğŸ† å®¶æ—æœ‰ä¸“ä¸šè¿åŠ¨å‘˜</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'family_sports', event)">
                            <input type="checkbox" value="amateur" class="checkbox-input">
                            <span>ğŸƒâ€â™€ï¸ çˆ¶æ¯ç»å¸¸è¿åŠ¨</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'family_sports', event)">
                            <input type="checkbox" value="genes" class="checkbox-input">
                            <span>ğŸ§¬ æœ‰è¿åŠ¨å¤©èµ‹åŸºå› </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ­¥éª¤2: å…´è¶£æ¢ç´¢ -->
        <div class="step" data-step="2">
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h2 class="card-title">è¿åŠ¨å…´è¶£</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æœ€å–œæ¬¢çš„è¿åŠ¨é¡¹ç›® (å¯å¤šé€‰)</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="swimming" class="checkbox-input">
                            <span>ğŸŠâ€â™‚ï¸ æ¸¸æ³³</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="basketball" class="checkbox-input">
                            <span>ğŸ€ ç¯®çƒ</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="soccer" class="checkbox-input">
                            <span>âš½ è¶³çƒ</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="tennis" class="checkbox-input">
                            <span>ğŸ¾ ç½‘çƒ</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="gymnastics" class="checkbox-input">
                            <span>ğŸ¤¸â€â™€ï¸ ä½“æ“</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'interests', event)">
                            <input type="checkbox" value="track" class="checkbox-input">
                            <span>ğŸƒâ€â™‚ï¸ ç”°å¾„</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">æ¯å‘¨è¿åŠ¨é¢‘ç‡</label>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'frequency', '1-2', event)">
                            <input type="radio" name="frequency" value="1-2" class="radio-input">
                            <span>ğŸ“… æ¯å‘¨1-2æ¬¡</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'frequency', '3-4', event)">
                            <input type="radio" name="frequency" value="3-4" class="radio-input">
                            <span>ğŸ“… æ¯å‘¨3-4æ¬¡</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'frequency', '5+', event)">
                            <input type="radio" name="frequency" value="5+" class="radio-input">
                            <span>ğŸ“… æ¯å‘¨5æ¬¡ä»¥ä¸Š</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ­¥éª¤3: èº«ä½“è¯„ä¼° -->
        <div class="step" data-step="3">
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <h2 class="card-title">èº«ä½“çŠ¶å†µ</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">èº«ä½“ç´ è´¨è¯„ä¼°</label>
                    <div class="form-group">
                        <label class="form-label">ğŸƒâ€â™‚ï¸ çŸ­è·ç¦»å†²åˆºæµ‹è¯•</label>
                        <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                            ğŸ’¡ <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong>åœ¨å®¶ä¸­èµ°å»Šæˆ–å°åŒºç©ºåœ°ï¼Œè®©å­©å­å…¨åŠ›å†²åˆºçº¦10ç±³è·ç¦»ã€‚è§‚å¯Ÿä¸åŒé¾„å­©å­ç›¸æ¯”çš„é€Ÿåº¦è¡¨ç°ã€‚
                        </p>
                        <div class="radio-group">
                            <div class="radio-item" onclick="selectRadio(this, 'speed', 'excellent', event)">
                                <input type="radio" name="speed" value="excellent" class="radio-input">
                                <span>ğŸ¥‡ æ˜æ˜¾æ¯”åŒé¾„å­©å­å¿«ï¼ˆååº”è¿…é€Ÿï¼Œå¯åŠ¨å¿«ï¼Œæ­¥é¢‘é«˜ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'speed', 'good', event)">
                                <input type="radio" name="speed" value="good" class="radio-input">
                                <span>ğŸ¥ˆ æ¯”å¤§éƒ¨åˆ†åŒé¾„å­©å­å¿«ï¼ˆè·‘èµ·æ¥æ¯”è¾ƒè½»æ¾ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'speed', 'average', event)">
                                <input type="radio" name="speed" value="average" class="radio-input">
                                <span>ğŸ¥‰ å’Œå¤§éƒ¨åˆ†åŒé¾„å­©å­å·®ä¸å¤šï¼ˆä¸­ç­‰æ°´å¹³ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'speed', 'poor', event)">
                                <input type="radio" name="speed" value="poor" class="radio-input">
                                <span>ğŸ“ æ¯”å¤§éƒ¨åˆ†åŒé¾„å­©å­æ…¢ï¼ˆè·‘èµ·æ¥æ¯”è¾ƒåƒåŠ›ï¼‰</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ¦˜ ç«‹å®šè·³è¿œæµ‹è¯•</label>
                        <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                            ğŸ’¡ <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong>è®©å­©å­åŒè„šå¹¶æ‹¢ç«™ç«‹ï¼ŒåŸåœ°ç”¨åŠ›å‘å‰è·³ã€‚å¯ç”¨å·å°ºæµ‹é‡è·ç¦»ï¼Œæˆ–ç”¨åœ°ç –/A4çº¸ï¼ˆçº¦30cmï¼‰ä½œä¸ºå‚ç…§ã€‚
                        </p>
                        <div class="radio-group">
                            <div class="radio-item" onclick="selectRadio(this, 'strength', 'excellent', event)">
                                <input type="radio" name="strength" value="excellent" class="radio-input">
                                <span>ğŸ¥‡ èƒ½è·³è¿‡1ç±³ä»¥ä¸Šï¼ˆçº¦3-4å¼ A4çº¸é•¿åº¦ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'strength', 'good', event)">
                                <input type="radio" name="strength" value="good" class="radio-input">
                                <span>ğŸ¥ˆ èƒ½è·³è¿‡80-100å˜ç±³ï¼ˆçº¦2.5-3å¼ A4çº¸ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'strength', 'average', event)">
                                <input type="radio" name="strength" value="average" class="radio-input">
                                <span>ğŸ¥‰ èƒ½è·³è¿‡60-80å˜ç±³ï¼ˆçº¦2-2.5å¼ A4çº¸ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'strength', 'poor', event)">
                                <input type="radio" name="strength" value="poor" class="radio-input">
                                <span>ğŸ“ è·³ä¸è¿‡60å˜ç±³ï¼ˆå°‘äº2å¼ A4çº¸ï¼‰</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ¤¹â€â™‚ï¸ å•è„šå¹³è¡¡æµ‹è¯•</label>
                        <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                            ğŸ’¡ <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong>è®©å­©å­å•è„šç«™ç«‹ï¼ˆå¦ä¸€åªè„šæŠ¬èµ·ï¼‰ï¼ŒåŒæ‰‹å‰è…°æˆ–ä¼¸å±•ä¿æŒå¹³è¡¡ã€‚è§‚å¯Ÿèƒ½åšæŒå¤šä¹…ä¸æ™ƒåŠ¨ã€‚
                        </p>
                        <div class="radio-group">
                            <div class="radio-item" onclick="selectRadio(this, 'coordination', 'excellent', event)">
                                <input type="radio" name="coordination" value="excellent" class="radio-input">
                                <span>ğŸ¥‡ èƒ½ç¨³å®šç«™ç«‹30ç§’ä»¥ä¸Šï¼ˆé—­çœ¼ä¹Ÿèƒ½ç«™10ç§’+ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'coordination', 'good', event)">
                                <input type="radio" name="coordination" value="good" class="radio-input">
                                <span>ğŸ¥ˆ èƒ½ç«™ç«‹15-30ç§’ï¼ˆèº«ä½“å¶å°”æ™ƒåŠ¨ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'coordination', 'average', event)">
                                <input type="radio" name="coordination" value="average" class="radio-input">
                                <span>ğŸ¥‰ èƒ½ç«™ç«‹5-15ç§’ï¼ˆéœ€è¦è°ƒæ•´å§¿åŠ¿ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'coordination', 'poor', event)">
                                <input type="radio" name="coordination" value="poor" class="radio-input">
                                <span>ğŸ“ ç«™ä¸åˆ°5ç§’ï¼ˆå¾ˆå¿«å¤±å»å¹³è¡¡ï¼‰</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ğŸ§˜ æŸ”éŸ§æ€§æµ‹è¯•ï¼ˆåä½ä½“å‰å±ˆï¼‰</label>
                        <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                            ğŸ’¡ <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong>è®©å­©å­ååœ¨åœ°ä¸Šï¼ŒåŒè…¿ä¼¸ç›´å¹¶æ‹¢ï¼Œè„šå°–æœä¸Šã€‚èº«ä½“å‰å€¾ï¼ŒåŒæ‰‹æ…¢æ…¢å‘å‰ä¼¸ï¼Œå°è¯•è§¦ç¢°è„šè¶¾ã€‚
                        </p>
                        <div class="radio-group">
                            <div class="radio-item" onclick="selectRadio(this, 'flexibility', 'excellent', event)">
                                <input type="radio" name="flexibility" value="excellent" class="radio-input">
                                <span>ğŸ¥‡ æ‰‹æŒèƒ½å®Œå…¨è¶…è¿‡è„šè¶¾5å˜ç±³ä»¥ä¸Šï¼ˆæŸ”éŸ§æ€§ä¼˜ç§€ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'flexibility', 'good', event)">
                                <input type="radio" name="flexibility" value="good" class="radio-input">
                                <span>ğŸ¥ˆ æ‰‹æŒ‡èƒ½è§¦ç¢°åˆ°è„šè¶¾æˆ–ç•¥å¾®è¶…è¿‡ï¼ˆæŸ”éŸ§æ€§è‰¯å¥½ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'flexibility', 'average', event)">
                                <input type="radio" name="flexibility" value="average" class="radio-input">
                                <span>ğŸ¥‰ æ‰‹æŒ‡è·ç¦»è„šè¶¾5-10å˜ç±³ï¼ˆæŸ”éŸ§æ€§ä¸€èˆ¬ï¼‰</span>
                            </div>
                            <div class="radio-item" onclick="selectRadio(this, 'flexibility', 'poor', event)">
                                <input type="radio" name="flexibility" value="poor" class="radio-input">
                                <span>ğŸ“ æ‰‹æŒ‡è·ç¦»è„šè¶¾è¶…è¿‡10å˜ç±³ï¼ˆéœ€è¦åŠ å¼ºæŸ”éŸ§æ€§è®­ç»ƒï¼‰</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ­¥éª¤4: è¿åŠ¨è¡¨ç° -->
        <div class="step" data-step="4">
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h2 class="card-title">è¿åŠ¨è¡¨ç°</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å‚åŠ è¿‡çš„è¿åŠ¨è®­ç»ƒ</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'training', event)">
                            <input type="checkbox" value="swimming_course" class="checkbox-input">
                            <span>ğŸŠâ€â™‚ï¸ æ¸¸æ³³è¯¾ç¨‹</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'training', event)">
                            <input type="checkbox" value="ball_sports" class="checkbox-input">
                            <span>âš½ çƒç±»è¿åŠ¨</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'training', event)">
                            <input type="checkbox" value="martial_arts" class="checkbox-input">
                            <span>ğŸ¥‹ æ­¦æœ¯/è·†æ‹³é“</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'training', event)">
                            <input type="checkbox" value="dance" class="checkbox-input">
                            <span>ğŸ’ƒ èˆè¹ˆ</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'training', event)">
                            <input type="checkbox" value="none" class="checkbox-input">
                            <span>âŒ æš‚æ— ç³»ç»Ÿè®­ç»ƒ</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ğŸ¯ è¿åŠ¨æŠ€èƒ½å­¦ä¹ é€Ÿåº¦è§‚å¯Ÿ</label>
                    <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                        ğŸ’¡ <strong>è§‚å¯Ÿé‡ç‚¹ï¼š</strong>å›å¿†å­©å­å­¦ä¹ æ–°è¿åŠ¨æŠ€èƒ½ï¼ˆå¦‚éª‘è½¦ã€è·³ç»³ã€æ‹çƒã€æ¸¸æ³³ï¼‰æ—¶çš„è¡¨ç°ã€‚
                    </p>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'learning_ability', 'fast', event)">
                            <input type="radio" name="learning_ability" value="fast" class="radio-input">
                            <span>ğŸš€ å¾ˆå¿«æŒæ¡ï¼ˆé€šå¸¸å‡ æ¬¡ç¤ºèŒƒå°±èƒ½æ¨¡ä»¿ï¼Œä¸åˆ°ä¸€å‘¨å°±èƒ½ç†Ÿç»ƒï¼‰</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'learning_ability', 'normal', event)">
                            <input type="radio" name="learning_ability" value="normal" class="radio-input">
                            <span>ğŸ“š æ­£å¸¸é€Ÿåº¦ï¼ˆéœ€è¦1-2å‘¨åå¤ç»ƒä¹ æ‰èƒ½æŒæ¡åŸºæœ¬åŠ¨ä½œï¼‰</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'learning_ability', 'slow', event)">
                            <input type="radio" name="learning_ability" value="slow" class="radio-input">
                            <span>ğŸ¢ å­¦å¾—è¾ƒæ…¢ï¼ˆéœ€è¦å‡ å‘¨ç”šè‡³æ›´é•¿æ—¶é—´ï¼Œéœ€è¦å¤§é‡è€å¿ƒæŒ‡å¯¼ï¼‰</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ğŸ’ª é¢å¯¹å›°éš¾å’Œå¤±è´¥æ—¶çš„ååº”</label>
                    <p class="form-hint" style="color: #64748b; font-size: 14px; margin-bottom: 12px;">
                        ğŸ’¡ <strong>åœºæ™¯å›å¿†ï¼š</strong>æƒ³æƒ³å­©å­åœ¨è¿åŠ¨ä¸­é‡åˆ°å›°éš¾æ—¶ï¼ˆå¦‚è¿ç»­æŠ•ç¯®ä¸ä¸­ã€è·‘æ­¥è½åã€å­¦ä¸ä¼šæŸä¸ªåŠ¨ä½œï¼‰çš„è¡¨ç°ã€‚
                    </p>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'challenge_attitude', 'positive', event)">
                            <input type="radio" name="challenge_attitude" value="positive" class="radio-input">
                            <span>ğŸ”¥ è¶ŠæŒ«è¶Šå‹‡ï¼ˆå¤±è´¥åæ›´åŠªåŠ›ï¼Œä¸»åŠ¨è¦æ±‚å†è¯•ä¸€æ¬¡ï¼‰</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'challenge_attitude', 'need_encourage', event)">
                            <input type="radio" name="challenge_attitude" value="need_encourage" class="radio-input">
                            <span>ğŸ¤— éœ€è¦é¼“åŠ±ï¼ˆå¤±è´¥åæƒ…ç»ªä½è½ï¼Œéœ€è¦å¤§äººå®‰æ…°å’Œé¼“åŠ±æ‰èƒ½ç»§ç»­ï¼‰</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'challenge_attitude', 'give_up_easily', event)">
                            <input type="radio" name="challenge_attitude" value="give_up_easily" class="radio-input">
                            <span>ğŸ˜” å®¹æ˜“æ”¾å¼ƒï¼ˆé‡åˆ°å›°éš¾å°±è¯´"æˆ‘ä¸æƒ³ç©äº†"ã€"å¤ªéš¾äº†"ï¼‰</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ­¥éª¤5: æœŸæœ›ç›®æ ‡ -->
        <div class="step" data-step="5">
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-target"></i>
                    </div>
                    <h2 class="card-title">å‘å±•æœŸæœ›</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">è¿åŠ¨å‘å±•ç›®æ ‡</label>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'goal', 'health', event)">
                            <input type="radio" name="goal" value="health" class="radio-input">
                            <span>ğŸŒŸ å¥åº·æˆé•¿ï¼Œå¢å¼ºä½“è´¨</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'goal', 'hobby', event)">
                            <input type="radio" name="goal" value="hobby" class="radio-input">
                            <span>ğŸ¯ åŸ¹å…»è¿åŠ¨çˆ±å¥½</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'goal', 'professional', event)">
                            <input type="radio" name="goal" value="professional" class="radio-input">
                            <span>ğŸ† ä¸“ä¸šè¿åŠ¨å‘å±•</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'goal', 'competition', event)">
                            <input type="radio" name="goal" value="competition" class="radio-input">
                            <span>ğŸ¥‡ ç«æŠ€ä½“è‚²é“è·¯</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">å¯æŠ•å…¥çš„æ—¶é—´</label>
                    <div class="radio-group">
                        <div class="radio-item" onclick="selectRadio(this, 'time_commitment', 'low', event)">
                            <input type="radio" name="time_commitment" value="low" class="radio-input">
                            <span>â° æ¯å‘¨1-2å°æ—¶</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'time_commitment', 'medium', event)">
                            <input type="radio" name="time_commitment" value="medium" class="radio-input">
                            <span>â° æ¯å‘¨3-5å°æ—¶</span>
                        </div>
                        <div class="radio-item" onclick="selectRadio(this, 'time_commitment', 'high', event)">
                            <input type="radio" name="time_commitment" value="high" class="radio-input">
                            <span>â° æ¯å‘¨6å°æ—¶ä»¥ä¸Š</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">è”ç³»æ–¹å¼</label>
                    <input type="tel" class="form-input" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç " id="phoneNumber">
                </div>
            </div>
        </div>

        <!-- ç»“æœé¡µé¢ -->
        <div class="step result-container" data-step="result">
            <div class="score-card fade-in pulse">
                <div class="total-score" id="totalScore">85</div>
                <div class="score-label">ç»¼åˆè¯„ä¼°åˆ†æ•°</div>
            </div>

            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-chart-radar"></i>
                    </div>
                    <h2 class="card-title">èƒ½åŠ›é›·è¾¾å›¾</h2>
                </div>
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>

            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2 class="card-title">æ¨èè¿åŠ¨é¡¹ç›®</h2>
                </div>
                <ul class="recommendation-list" id="recommendationList">
                    <!-- åŠ¨æ€ç”Ÿæˆæ¨èå†…å®¹ -->
                </ul>
            </div>

            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h2 class="card-title">ä¸ªæ€§åŒ–å»ºè®®</h2>
                </div>
                <div id="personalizedAdvice">
                    <!-- åŠ¨æ€ç”Ÿæˆå»ºè®®å†…å®¹ -->
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨å¯¼èˆª -->
        <div class="bottom-nav">
            <button class="btn btn-secondary" id="prevBtn" onclick="previousStep()" style="display: none;">
                <i class="fas fa-arrow-left"></i> ä¸Šä¸€æ­¥
            </button>
            <button class="btn btn-primary btn-block" id="nextBtn" onclick="nextStep()">
                ä¸‹ä¸€æ­¥ <i class="fas fa-arrow-right"></i>
            </button>
            <button class="btn btn-success" id="generateBtn" onclick="generateReport()" style="display: none;">
                <i class="fas fa-download"></i> ç”ŸæˆæŠ¥å‘Š
            </button>
        </div>
    </div>

    <script>
        // ===== å…¨å±€å˜é‡ =====
        let currentStep = 1;
        const totalSteps = 5;
        const formData = {};
        let isDesktop = false;

        // ===== è®¾å¤‡æ£€æµ‹ =====
        function detectDevice() {
            isDesktop = window.innerWidth >= 768;
            
            // æ˜¾ç¤ºæ¡Œé¢ç«¯å¿«æ·é”®æç¤º
            const keyboardHint = document.querySelector('.keyboard-hint');
            if (keyboardHint) {
                keyboardHint.style.display = isDesktop ? 'block' : 'none';
            }
        }

        // ===== é”®ç›˜å¿«æ·é”®æ”¯æŒ =====
        function setupKeyboardShortcuts() {
            if (!isDesktop) return;
            
            document.addEventListener('keydown', function(e) {
                switch(e.key) {
                    case 'ArrowRight':
                    case 'Enter':
                        e.preventDefault();
                        nextStep();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousStep();
                        break;
                    case 'Escape':
                        e.preventDefault();
                        if (currentStep > 1) previousStep();
                        break;
                }
            });
        }

        // ===== æ­¥éª¤ç®¡ç† =====
        function nextStep() {
            if (currentStep < totalSteps) {
                saveCurrentStepData();
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                currentStep++;
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                updateStepIndicator();
                updateButtonState();
                window.scrollTo(0, 0);
            } else {
                showResults();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                currentStep--;
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                updateStepIndicator();
                updateButtonState();
                window.scrollTo(0, 0);
            }
        }

        function updateStepIndicator() {
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                const stepNumber = index + 1;
                dot.classList.remove('active', 'completed');
                
                if (stepNumber === currentStep) {
                    dot.classList.add('active');
                } else if (stepNumber < currentStep) {
                    dot.classList.add('completed');
                }
            });
        }

        function updateButtonState() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentStep > 1 ? 'inline-flex' : 'none';
            
            if (currentStep === totalSteps) {
                nextBtn.textContent = 'ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š';
                nextBtn.innerHTML = '<i class="fas fa-chart-bar"></i> ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š';
            } else {
                nextBtn.innerHTML = 'ä¸‹ä¸€æ­¥ <i class="fas fa-arrow-right"></i>';
            }
        }

        // ===== è¡¨å•äº¤äº’ =====
        function selectRadio(element, name, value, event) {
            // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…é‡å¤è§¦å‘
            if (event) {
                event.stopPropagation();
            }

            // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
            document.querySelectorAll(`input[name="${name}"]`).forEach(input => {
                input.closest('.radio-item').classList.remove('selected');
                input.checked = false;
            });

            // å¦‚æœç‚¹å‡»çš„æ˜¯radioæœ¬èº«ï¼Œå®ƒå·²ç»è‡ªåŠ¨é€‰ä¸­äº†
            // åªæœ‰ç‚¹å‡»å¤–å±‚divæ—¶æ‰éœ€è¦æ‰‹åŠ¨é€‰ä¸­
            const radio = element.querySelector('input[type="radio"]');
            if (event && event.target.type !== 'radio') {
                radio.checked = true;
            }

            element.classList.add('selected');
            formData[name] = value;
        }

        function toggleCheckbox(element, groupName, event) {
            // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…é‡å¤è§¦å‘
            if (event) {
                event.stopPropagation();
            }

            const checkbox = element.querySelector('input[type="checkbox"]');

            // å¦‚æœç‚¹å‡»çš„æ˜¯checkboxæœ¬èº«ï¼Œå®ƒå·²ç»è‡ªåŠ¨åˆ‡æ¢äº†ï¼Œä¸éœ€è¦å†åˆ‡æ¢
            // åªæœ‰ç‚¹å‡»å¤–å±‚divæ—¶æ‰éœ€è¦æ‰‹åŠ¨åˆ‡æ¢
            if (event && event.target.type !== 'checkbox') {
                checkbox.checked = !checkbox.checked;
            }

            const isChecked = checkbox.checked;

            if (isChecked) {
                element.classList.add('selected');
            } else {
                element.classList.remove('selected');
            }

            if (!formData[groupName]) {
                formData[groupName] = [];
            }

            const value = checkbox.value;
            if (isChecked && !formData[groupName].includes(value)) {
                formData[groupName].push(value);
            } else if (!isChecked) {
                formData[groupName] = formData[groupName].filter(v => v !== value);
            }
        }

        function saveCurrentStepData() {
            const currentStepElement = document.querySelector(`.step[data-step="${currentStep}"]`);
            const inputs = currentStepElement.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    if (input.checked && input.name) {
                        if (input.type === 'checkbox') {
                            if (!formData[input.name]) formData[input.name] = [];
                            if (!formData[input.name].includes(input.value)) {
                                formData[input.name].push(input.value);
                            }
                        } else {
                            formData[input.name] = input.value;
                        }
                    }
                } else if (input.id && input.value) {
                    formData[input.id] = input.value;
                }
            });
        }

        // ===== ç»“æœç”Ÿæˆ =====
        function showResults() {
            saveCurrentStepData();
            document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
            document.querySelector('.step[data-step="result"]').classList.add('active');
            
            document.getElementById('prevBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('generateBtn').style.display = 'inline-flex';
            
            calculateAndShowResults();
        }

        function calculateAndShowResults() {
            const score = calculateTotalScore();
            document.getElementById('totalScore').textContent = score;
            createRadarChart();
            generateRecommendations();
            generatePersonalizedAdvice();
        }

        function calculateTotalScore() {
            let score = 60;
            
            if (formData.speed === 'excellent') score += 10;
            else if (formData.speed === 'good') score += 7;
            else if (formData.speed === 'average') score += 4;
            
            if (formData.strength === 'excellent') score += 10;
            else if (formData.strength === 'good') score += 7;
            else if (formData.strength === 'average') score += 4;
            
            if (formData.coordination === 'excellent') score += 10;
            else if (formData.coordination === 'good') score += 7;
            else if (formData.coordination === 'average') score += 4;
            
            if (formData.learning_ability === 'fast') score += 8;
            else if (formData.learning_ability === 'normal') score += 5;
            
            if (formData.challenge_attitude === 'positive') score += 7;
            else if (formData.challenge_attitude === 'need_encourage') score += 4;
            
            if (formData.interests && formData.interests.length > 0) {
                score += formData.interests.length * 2;
            }
            
            return Math.min(score, 100);
        }

        function createRadarChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            const speedScore = getScoreFromRating(formData.speed);
            const strengthScore = getScoreFromRating(formData.strength);
            const coordinationScore = getScoreFromRating(formData.coordination);
            const learningScore = formData.learning_ability === 'fast' ? 90 : 
                                formData.learning_ability === 'normal' ? 70 : 50;
            const attitudeScore = formData.challenge_attitude === 'positive' ? 90 :
                                formData.challenge_attitude === 'need_encourage' ? 70 : 50;
            const interestScore = formData.interests ? Math.min(formData.interests.length * 20, 100) : 60;
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['é€Ÿåº¦', 'åŠ›é‡', 'åè°ƒæ€§', 'å­¦ä¹ èƒ½åŠ›', 'æŒ‘æˆ˜æ€åº¦', 'è¿åŠ¨å…´è¶£'],
                    datasets: [{
                        label: 'èƒ½åŠ›è¯„ä¼°',
                        data: [speedScore, strengthScore, coordinationScore, learningScore, attitudeScore, interestScore],
                        borderColor: '#ff7a45',
                        backgroundColor: 'rgba(255, 122, 69, 0.2)',
                        borderWidth: 3,
                        pointBackgroundColor: '#ff7a45',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                color: '#64748b'
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            pointLabels: {
                                font: {
                                    size: isDesktop ? 16 : 14,
                                    family: '-apple-system, BlinkMacSystemFont, PingFang SC'
                                },
                                color: '#1e293b'
                            }
                        }
                    }
                }
            });
        }

        function getScoreFromRating(rating) {
            switch (rating) {
                case 'excellent': return 95;
                case 'good': return 80;
                case 'average': return 65;
                case 'poor': return 45;
                default: return 60;
            }
        }

        function generateRecommendations() {
            const recommendationList = document.getElementById('recommendationList');
            const recommendations = getRecommendations();
            
            recommendationList.innerHTML = recommendations.map(rec => `
                <li class="recommendation-item">
                    <div class="recommendation-icon">
                        <i class="${rec.icon}"></i>
                    </div>
                    <div>
                        <strong>${rec.sport}</strong>
                        <p style="margin: 4px 0 0 0; color: var(--text-muted); font-size: 14px;">
                            ${rec.reason}
                        </p>
                    </div>
                </li>
            `).join('');
        }

        function getRecommendations() {
            const recommendations = [];
            
            if (formData.interests && formData.interests.includes('swimming')) {
                recommendations.push({
                    sport: 'æ¸¸æ³³ä¸“é¡¹è®­ç»ƒ',
                    reason: 'æ‚¨çš„å­©å­å¯¹æ¸¸æ³³å¾ˆæ„Ÿå…´è¶£ï¼Œé€‚åˆæ·±å…¥å‘å±•',
                    icon: 'fas fa-swimmer'
                });
            }
            
            if (formData.interests && formData.interests.includes('basketball')) {
                recommendations.push({
                    sport: 'ç¯®çƒåŸºç¡€è®­ç»ƒ',
                    reason: 'çƒç±»è¿åŠ¨æœ‰åŠ©äºæé«˜åè°ƒæ€§å’Œå›¢é˜Ÿç²¾ç¥',
                    icon: 'fas fa-basketball-ball'
                });
            }
            
            if (formData.speed === 'excellent') {
                recommendations.push({
                    sport: 'ç”°å¾„çŸ­è·‘',
                    reason: 'é€Ÿåº¦è¡¨ç°ä¼˜ç§€ï¼Œé€‚åˆå‘å±•çŸ­è·‘é¡¹ç›®',
                    icon: 'fas fa-running'
                });
            }
            
            if (formData.coordination === 'excellent') {
                recommendations.push({
                    sport: 'ä½“æ“/è‰ºæœ¯ä½“æ“',
                    reason: 'åè°ƒæ€§ä¼˜ç§€ï¼Œé€‚åˆæŠ€å·§ç±»è¿åŠ¨',
                    icon: 'fas fa-child'
                });
            }
            
            if (recommendations.length === 0) {
                recommendations.push(
                    {
                        sport: 'ç»¼åˆä½“èƒ½è®­ç»ƒ',
                        reason: 'å»ºç«‹è‰¯å¥½çš„è¿åŠ¨åŸºç¡€ï¼Œå…¨é¢å‘å±•èº«ä½“ç´ è´¨',
                        icon: 'fas fa-dumbbell'
                    },
                    {
                        sport: 'è¶£å‘³è¿åŠ¨æ¸¸æˆ',
                        reason: 'åŸ¹å…»è¿åŠ¨å…´è¶£ï¼Œåœ¨æ¸¸æˆä¸­æé«˜è¿åŠ¨èƒ½åŠ›',
                        icon: 'fas fa-gamepad'
                    }
                );
            }
            
            return recommendations.slice(0, 3);
        }

        function generatePersonalizedAdvice() {
            const adviceContainer = document.getElementById('personalizedAdvice');
            const advice = getPersonalizedAdvice();
            
            adviceContainer.innerHTML = `
                <div style="background: var(--secondary); padding: 16px; border-radius: var(--radius); margin-bottom: 16px;">
                    <h4 style="margin-bottom: 8px; color: var(--text);">ğŸ¯ å‘å±•å»ºè®®</h4>
                    <p style="margin: 0; color: var(--text-muted); line-height: 1.6;">${advice.development}</p>
                </div>
                <div style="background: rgba(16, 185, 129, 0.1); padding: 16px; border-radius: var(--radius); margin-bottom: 16px;">
                    <h4 style="margin-bottom: 8px; color: var(--success);">ğŸ’¡ è®­ç»ƒé‡ç‚¹</h4>
                    <p style="margin: 0; color: var(--text-muted); line-height: 1.6;">${advice.training}</p>
                </div>
                <div style="background: rgba(245, 158, 11, 0.1); padding: 16px; border-radius: var(--radius);">
                    <h4 style="margin-bottom: 8px; color: var(--warning);">âš ï¸ æ³¨æ„äº‹é¡¹</h4>
                    <p style="margin: 0; color: var(--text-muted); line-height: 1.6;">${advice.caution}</p>
                </div>
            `;
        }

        function getPersonalizedAdvice() {
            let development = 'å»ºè®®é€‰æ‹©1-2ä¸ªä¸»è¦è¿åŠ¨é¡¹ç›®è¿›è¡Œç³»ç»Ÿè®­ç»ƒï¼ŒåŒæ—¶ä¿æŒå¤šæ ·åŒ–çš„è¿åŠ¨ä½“éªŒã€‚';
            let training = 'é‡ç‚¹åŸ¹å…»åŸºç¡€è¿åŠ¨æŠ€èƒ½ï¼Œå¦‚è·‘ã€è·³ã€æŠ•ã€æ”€çˆ¬ç­‰ï¼Œä¸ºä¸“é¡¹è¿åŠ¨æ‰“å¥½åŸºç¡€ã€‚';
            let caution = 'æ³¨æ„è¿åŠ¨å¼ºåº¦é€‚ä¸­ï¼Œé¿å…è¿‡æ—©ä¸“ä¸šåŒ–è®­ç»ƒï¼Œä¿æŠ¤å­©å­çš„è¿åŠ¨å…´è¶£å’Œèº«ä½“å¥åº·ã€‚';
            
            if (formData.goal === 'professional') {
                development = 'å­©å­æœ‰ä¸“ä¸šå‘å±•æ„æ„¿ï¼Œå»ºè®®å¯»æ‰¾ä¸“ä¸šæ•™ç»ƒï¼Œåˆ¶å®šç³»ç»Ÿæ€§è®­ç»ƒè®¡åˆ’ã€‚';
                training = 'åŠ å¼ºä¸“é¡¹æŠ€èƒ½è®­ç»ƒï¼ŒåŒæ—¶æ³¨é‡ä½“èƒ½å’Œå¿ƒç†ç´ è´¨çš„å…¨é¢æå‡ã€‚';
            } else if (formData.goal === 'health') {
                development = 'ä»¥å¥åº·ä¸ºä¸»è¦ç›®æ ‡ï¼Œå»ºè®®é€‰æ‹©å­©å­å–œæ¬¢çš„è¿åŠ¨é¡¹ç›®ï¼Œé‡åœ¨åšæŒå’Œäº«å—ã€‚';
                training = 'æ³¨é‡è¶£å‘³æ€§å’Œå¤šæ ·æ€§ï¼ŒåŸ¹å…»ç»ˆèº«è¿åŠ¨ä¹ æƒ¯æ¯”æŠ€æœ¯æ°´å¹³æ›´é‡è¦ã€‚';
            }
            
            if (formData.challenge_attitude === 'give_up_easily') {
                caution = 'å­©å­å®¹æ˜“æ”¾å¼ƒï¼Œå»ºè®®é€‰æ‹©è¶£å‘³æ€§å¼ºçš„é¡¹ç›®ï¼Œå¤šç»™äºˆé¼“åŠ±å’Œæ”¯æŒï¼Œå¾ªåºæ¸è¿›æå‡éš¾åº¦ã€‚';
            }
            
            return { development, training, caution };
        }

        function generateReport() {
            const loading = document.querySelector('.loading') || createLoadingElement();
            loading.style.display = 'flex';

            setTimeout(() => {
                try {
                    // æ£€æŸ¥è¯„åˆ†å¼•æ“æ˜¯å¦åŠ è½½
                    if (typeof window.SportsAssessment === 'undefined') {
                        throw new Error('è¯„åˆ†å¼•æ“æœªæ­£ç¡®åŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                    }

                    // 1. è½¬æ¢è¡¨å•æ•°æ®ä¸ºè¯„ä¼°å¼•æ“æ ¼å¼
                    const assessmentInput = convertFormDataToAssessmentInput();
                    console.log('è¯„ä¼°è¾“å…¥æ•°æ®:', assessmentInput);

                    // 2. è°ƒç”¨è¯„åˆ†å¼•æ“ç”Ÿæˆè¯„ä¼°ç»“æœ
                    const result = window.SportsAssessment.evaluate(assessmentInput);
                    console.log('è¯„ä¼°ç»“æœ:', result);

                    // 3. æ˜¾ç¤ºä¸“ä¸šæŠ¥å‘Š
                    showProfessionalReport(result, assessmentInput);

                    loading.style.display = 'none';
                } catch (error) {
                    loading.style.display = 'none';
                    console.error('ç”ŸæˆæŠ¥å‘Šæ—¶å‡ºé”™:', error);
                    console.error('é”™è¯¯å †æ ˆ:', error.stack);
                    alert('ç”ŸæˆæŠ¥å‘Šæ—¶å‡ºé”™\n\né”™è¯¯è¯¦æƒ…: ' + error.message + '\n\nè¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯');
                }
            }, 1000);
        }

        // è½¬æ¢è¡¨å•æ•°æ®ä¸ºè¯„ä¼°å¼•æ“æ ¼å¼
        function convertFormDataToAssessmentInput() {
            return {
                child: {
                    name: formData.childName || 'æœªå¡«å†™',
                    gender: formData.gender === 'ç”·' ? 'male' : 'female',
                    age: calculateAge(formData.birthDate) || 6,
                    height: parseInt(formData.height) || undefined,
                    weight: parseInt(formData.weight) || undefined,
                    grade: 'kindergarten_large' // é»˜è®¤å€¼
                },
                family: {
                    father: parseInt(formData.fatherHeight) || undefined,
                    mother: parseInt(formData.motherHeight) || undefined
                },
                parents: {
                    father: {
                        sportExp: mapSportExp(formData.family_sports),
                        traits: formData.family_sports || []
                    },
                    mother: {
                        sportExp: mapSportExp(formData.family_sports),
                        traits: []
                    }
                },
                development: {
                    hasTraining: formData.training && formData.training.length > 0,
                    frequency: mapFrequency(formData.frequency),
                    interests: formData.interests || [],
                    basicSkills: {
                        run: formData.speed || 'average',
                        jump: formData.coordination || 'average',
                        throw: formData.strength || 'average',
                        climb: formData.coordination || 'average',
                        balance: formData.coordination || 'average'
                    }
                },
                specialty: {
                    aquatic: {
                        hasContact: formData.interests && formData.interests.includes('swimming'),
                        attitude: 'positive',
                        skills: formData.interests && formData.interests.includes('swimming') ? ['basic_float'] : []
                    },
                    ball: formData.interests ? formData.interests.filter(i => ['basketball', 'soccer', 'tennis'].includes(i)) : [],
                    track: formData.interests && formData.interests.includes('track') ? ['running'] : [],
                    tech: formData.interests && formData.interests.includes('gymnastics') ? ['flexibility'] : []
                },
                physical: {
                    healthy: true,
                    bodyType: 'standard'
                },
                psychology: {
                    personality: mapPersonality(formData.challenge_attitude),
                    resilience: mapResilience(formData.challenge_attitude),
                    teamwork: 'good'
                }
            };
        }

        // è¾…åŠ©æ˜ å°„å‡½æ•°
        function mapSportExp(familySports) {
            if (!familySports || familySports.length === 0) return 'rarely';
            if (familySports.includes('professional')) return 'professional';
            if (familySports.includes('amateur')) return 'amateur';
            return 'rarely';
        }

        function mapFrequency(freq) {
            const mapping = {
                '1-2': '1-2_times',
                '3-4': '3-4_times',
                '5+': '5plus_times'
            };
            return mapping[freq] || 'rarely';
        }

        function mapPersonality(attitude) {
            const mapping = {
                'positive': 'extroverted',
                'need_encourage': 'balanced',
                'give_up_easily': 'introverted'
            };
            return mapping[attitude] || 'balanced';
        }

        function mapResilience(attitude) {
            const mapping = {
                'positive': 'strong',
                'need_encourage': 'average',
                'give_up_easily': 'needs_support'
            };
            return mapping[attitude] || 'average';
        }

        function calculateAge(birthDate) {
            if (!birthDate) return null;
            const birth = new Date(birthDate);
            const today = new Date();
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            return age;
        }

        // æ˜¾ç¤ºä¸“ä¸šæŠ¥å‘Šï¼ˆæ–°çª—å£ï¼‰
        function showProfessionalReport(result, input) {
            const reportWindow = window.open('', '_blank', 'width=1200,height=800');

            const pathwayText = {
                'hobby': 'ä¸šä½™çˆ±å¥½çº§åˆ«',
                'recreational': 'å…´è¶£åŸ¹å…»çº§åˆ«',
                'competitive': 'ç«æŠ€å‚¨å¤‡çº§åˆ«',
                'elite': 'ä¸“ä¸šå‘å±•çº§åˆ«'
            };

            // è¿åŠ¨é¡¹ç›®åç§°æ˜ å°„å‡½æ•°
            const getSportName = (type) => {
                const mapping = {
                    'swimming': 'æ¸¸æ³³',
                    'basketball': 'ç¯®çƒ',
                    'soccer': 'è¶³çƒ',
                    'tennis': 'ç½‘çƒ',
                    'track': 'ç”°å¾„',
                    'gymnastics': 'ä½“æ“',
                    'aquatic': 'æ°´ä¸Šè¿åŠ¨',
                    'ball_sports': 'çƒç±»è¿åŠ¨',
                    'track_field': 'ç”°å¾„è¿åŠ¨',
                    'technical': 'æŠ€å·§ç±»è¿åŠ¨'
                };
                return mapping[type] || type;
            };

            // æ„å»ºæŠ¥å‘Š HTML - ä½¿ç”¨æ•°ç»„æ‹¼æ¥é¿å…è¶…å¤§æ¨¡æ¿å­—ç¬¦ä¸²
            const htmlParts = [];

            htmlParts.push('<!DOCTYPE html>');
            htmlParts.push('<html lang="zh-CN">');
            htmlParts.push('<head>');
            htmlParts.push('    <meta charset="UTF-8">');
            htmlParts.push('    <meta name="viewport" content="width=device-width, initial-scale=1.0">');
            htmlParts.push('    <title>å„¿ç«¥è¿åŠ¨å¤©èµ‹è¯„ä¼°æŠ¥å‘Š - ' + input.child.name + '<' + '/title>');
            htmlParts.push('    <style>');
            htmlParts.push('        * { margin: 0; padding: 0; box-sizing: border-box; }');
            htmlParts.push('        body {');
            htmlParts.push('            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;');
            htmlParts.push('            line-height: 1.6; color: #333; background: #f5f5f5; padding: 20px;');
            htmlParts.push('        }');
            htmlParts.push('        .report-container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }');
            htmlParts.push('        .report-header { text-align: center; border-bottom: 3px solid #29CC57; padding-bottom: 20px; margin-bottom: 30px; }');
            htmlParts.push('        .report-title { font-size: 28px; font-weight: 700; color: #1e293b; margin-bottom: 10px; }');
            htmlParts.push('        .report-subtitle { font-size: 14px; color: #64748b; }');
            htmlParts.push('        .child-info { background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%); padding: 20px; border-radius: 8px; margin-bottom: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }');
            htmlParts.push('        .info-item { display: flex; flex-direction: column; }');
            htmlParts.push('        .info-label { font-size: 12px; color: #64748b; margin-bottom: 4px; }');
            htmlParts.push('        .info-value { font-size: 16px; font-weight: 600; color: #1e293b; }');
            htmlParts.push('        .score-summary { background: linear-gradient(135deg, #29CC57 0%, #3de068 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; text-align: center; }');
            htmlParts.push('        .overall-score { font-size: 64px; font-weight: 800; margin: 10px 0; }');
            htmlParts.push('        .pathway-level { font-size: 24px; font-weight: 600; margin-top: 10px; }');
            htmlParts.push('        .section { margin-bottom: 30px; }');
            htmlParts.push('        .section-title { font-size: 20px; font-weight: 700; color: #1e293b; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }');
            htmlParts.push('        .dimension-scores { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }');
            htmlParts.push('        .dimension-card { background: #f8fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #29CC57; }');
            htmlParts.push('        .dimension-name { font-size: 14px; color: #64748b; margin-bottom: 8px; }');
            htmlParts.push('        .dimension-score { font-size: 32px; font-weight: 700; color: #1e293b; }');
            htmlParts.push('        .sports-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }');
            htmlParts.push('        .sport-item { background: #f8fafc; padding: 15px; border-radius: 8px; border: 2px solid #e2e8f0; }');
            htmlParts.push('        .sport-name { font-size: 16px; font-weight: 600; color: #1e293b; margin-bottom: 5px; }');
            htmlParts.push('        .sport-match { font-size: 14px; color: #29CC57; font-weight: 600; }');
            htmlParts.push('        .recommendations { background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #ff7a45; }');
            htmlParts.push('        .recommendation-item { margin-bottom: 15px; padding-left: 20px; position: relative; }');
            htmlParts.push('        .recommendation-item::before { content: "â€¢"; position: absolute; left: 0; color: #ff7a45; font-size: 20px; }');
            htmlParts.push('        .footer { margin-top: 40px; padding-top: 20px; border-top: 2px solid #e2e8f0; text-align: center; color: #64748b; font-size: 14px; }');
            htmlParts.push('        .action-buttons { margin-top: 20px; text-align: center; }');
            htmlParts.push('        .btn { display: inline-block; padding: 12px 24px; margin: 0 10px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; border: none; transition: all 0.3s; }');
            htmlParts.push('        .btn-primary { background: linear-gradient(135deg, #29CC57 0%, #3de068 100%); color: white; }');
            htmlParts.push('        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(41, 204, 87, 0.3); }');
            htmlParts.push('        .btn-secondary { background: white; color: #1e293b; border: 2px solid #e2e8f0; }');
            htmlParts.push('        @media print { body { background: white; padding: 0; } .report-container { box-shadow: none; } .action-buttons { display: none; } }');
            htmlParts.push('    <' + '/style>');
            htmlParts.push('<' + '/head>');
            htmlParts.push('<body>');
            htmlParts.push('    <div class="report-container">');
            htmlParts.push('        <div class="report-header">');
            htmlParts.push('            <div class="report-title">å„¿ç«¥è¿åŠ¨å¤©èµ‹è¯„ä¼°æŠ¥å‘Š<' + '/div>');
            htmlParts.push('            <div class="report-subtitle">ä¸“ä¸šç‰ˆ Â· ç”Ÿæˆæ—¶é—´: ' + new Date().toLocaleString('zh-CN') + '<' + '/div>');
            htmlParts.push('        <' + '/div>');

            // å„¿ç«¥ä¿¡æ¯
            htmlParts.push('        <div class="child-info">');
            htmlParts.push('            <div class="info-item"><div class="info-label">å§“å</div><div class="info-value">' + input.child.name + '</div><' + '/div>');
            htmlParts.push('            <div class="info-item"><div class="info-label">æ€§åˆ«</div><div class="info-value">' + (input.child.gender === 'male' ? 'ç”·' : 'å¥³') + '</div><' + '/div>');
            htmlParts.push('            <div class="info-item"><div class="info-label">å¹´é¾„</div><div class="info-value">' + input.child.age + ' å²</div><' + '/div>');
            if (input.child.height) {
                htmlParts.push('            <div class="info-item"><div class="info-label">èº«é«˜</div><div class="info-value">' + input.child.height + ' cm</div><' + '/div>');
            }
            if (input.child.weight) {
                htmlParts.push('            <div class="info-item"><div class="info-label">ä½“é‡</div><div class="info-value">' + input.child.weight + ' kg</div><' + '/div>');
            }
            htmlParts.push('        <' + '/div>');

            // ç»¼åˆè¯„åˆ†
            htmlParts.push('        <div class="score-summary">');
            htmlParts.push('            <div style="font-size: 18px; opacity: 0.95;">ç»¼åˆè¯„åˆ†<' + '/div>');
            htmlParts.push('            <div class="overall-score">' + result.overall + '<' + '/div>');
            htmlParts.push('            <div class="pathway-level">' + (pathwayText[result.pathway] || result.pathway) + '<' + '/div>');
            htmlParts.push('        <' + '/div>');

            // ç»´åº¦å¾—åˆ†
            htmlParts.push('        <div class="section">');
            htmlParts.push('            <div class="section-title">ç»´åº¦å¾—åˆ†è¯¦æƒ…<' + '/div>');
            htmlParts.push('            <div class="dimension-scores">');
            htmlParts.push('                <div class="dimension-card"><div class="dimension-name">é—ä¼ æ½œåŠ›</div><div class="dimension-score">' + result.scores.genetic + '</div><' + '/div>');
            htmlParts.push('                <div class="dimension-card"><div class="dimension-name">å½“å‰èƒ½åŠ›</div><div class="dimension-score">' + result.scores.current + '</div><' + '/div>');
            htmlParts.push('                <div class="dimension-card"><div class="dimension-name">ä¸“é¡¹æŠ€èƒ½</div><div class="dimension-score">' + result.scores.specialty + '</div><' + '/div>');
            htmlParts.push('                <div class="dimension-card"><div class="dimension-name">èº«ä½“çŠ¶å†µ</div><div class="dimension-score">' + result.scores.physical + '</div><' + '/div>');
            htmlParts.push('                <div class="dimension-card"><div class="dimension-name">å¿ƒç†ç‰¹å¾</div><div class="dimension-score">' + result.scores.psychology + '</div><' + '/div>');
            htmlParts.push('            <' + '/div>');
            htmlParts.push('        <' + '/div>');

            // æ¨èè¿åŠ¨é¡¹ç›®
            htmlParts.push('        <div class="section">');
            htmlParts.push('            <div class="section-title">æ¨èè¿åŠ¨é¡¹ç›®<' + '/div>');
            htmlParts.push('            <div class="sports-list">');
            result.suitableSports.slice(0, 6).forEach(sport => {
                htmlParts.push('                <div class="sport-item">');
                htmlParts.push('                    <div class="sport-name">' + getSportName(sport.type) + '<' + '/div>');
                htmlParts.push('                    <div class="sport-match">åŒ¹é…åº¦: ' + sport.matchScore + '%<' + '/div>');
                htmlParts.push('                <' + '/div>');
            });
            htmlParts.push('            <' + '/div>');
            htmlParts.push('        <' + '/div>');

            // ä¸“ä¸šå»ºè®®
            htmlParts.push('        <div class="section">');
            htmlParts.push('            <div class="section-title">ä¸“ä¸šå»ºè®®<' + '/div>');
            htmlParts.push('            <div class="recommendations">');
            result.recommendations.forEach(rec => {
                htmlParts.push('                <div class="recommendation-item">' + rec + '<' + '/div>');
            });
            htmlParts.push('            <' + '/div>');
            htmlParts.push('        <' + '/div>');

            // é¡µè„š
            htmlParts.push('        <div class="footer">');
            htmlParts.push('            <p><strong>å£°æ˜ï¼š</strong>æœ¬æŠ¥å‘ŠåŸºäºç§‘å­¦è¯„ä¼°æ¨¡å‹ç”Ÿæˆï¼Œä»…ä¾›ä¸“ä¸šå‚è€ƒã€‚<' + '/p>');
            htmlParts.push('            <p>æœ€ç»ˆè®­ç»ƒæ–¹æ¡ˆåº”ç»“åˆå„¿ç«¥å®é™…æƒ…å†µï¼Œç”±ä¸“ä¸šæ•™ç»ƒåˆ¶å®šã€‚<' + '/p>');
            htmlParts.push('        <' + '/div>');

            // æ“ä½œæŒ‰é’®
            htmlParts.push('        <div class="action-buttons">');
            htmlParts.push('            <button class="btn btn-primary" onclick="window.print()">æ‰“å°æŠ¥å‘Š<' + '/button>');
            htmlParts.push('            <button class="btn btn-secondary" onclick="window.close()">å…³é—­<' + '/button>');
            htmlParts.push('        <' + '/div>');
            htmlParts.push('    <' + '/div>');
            htmlParts.push('<' + '/body>');
            htmlParts.push('<' + '/html>');

            const reportHTML = htmlParts.join('\n');
            reportWindow.document.write(reportHTML);
            reportWindow.document.close();
        }

        function createLoadingElement() {
            const loading = document.createElement('div');
            loading.className = 'loading';
            loading.innerHTML = '<div class="loading-spinner"><' + '/div>';
            document.body.appendChild(loading);
            return loading;
        }

        // ===== åˆå§‹åŒ– =====
        document.addEventListener('DOMContentLoaded', function() {
            detectDevice();
            updateButtonState();
            setupKeyboardShortcuts();
            
            // ç›‘å¬çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', detectDevice);
            
            // æ·»åŠ è¾“å…¥äº‹ä»¶ç›‘å¬å™¨
            document.querySelectorAll('input, select, textarea').forEach(input => {
                input.addEventListener('change', function() {
                    if (this.id) {
                        formData[this.id] = this.value;
                    }
                });
            });
            
            // æ·»åŠ ä¸€äº›æ¼”ç¤ºæ•°æ®
            setTimeout(() => {
                if (document.getElementById('childName').value === '') {
                    document.getElementById('childName').value = 'å°æ˜';
                    document.getElementById('birthDate').value = '2015-05-15';
                    document.getElementById('height').value = '125';
                    document.getElementById('weight').value = '28';
                    document.getElementById('fatherHeight').value = '175';
                    document.getElementById('motherHeight').value = '160';
                }
            }, 1000);
        });
    </script>

    <!-- è¯„åˆ†å¼•æ“ - æ”¾åœ¨æœ€ååŠ è½½ï¼Œé¿å…é˜»å¡ä¸»è¦åŠŸèƒ½ -->
    <script src="domain/scoring.config.js"></script>
    <script src="domain/scoring.js"></script>
</body>
</html>